Changes only in Hortonworks github and not in Apache SPARK-2.1.1 and hence not covered by CHANGES.txt.

INCOMPATIBLE CHANGES

NEW FEATURES
    RMP-7559. Support virtualenv in PySpark (SPARK-13587)
IMPROVEMENTS
    RMP-6461: Add --jarDirs and SPARK_APP_JARS to include directories in spark-submit and spark-shell
    RMP-6448: hdp.version
    RMP-6954: SparkSQL Ranger integration for fine grained access control in Spark 2.1
    BUG-62302 Support HiveServer2 delegation token acquisition in Spark

BUG FIXES
    BUG-73561  Virtualenv example fails in yarn-cluster mode with requirement.txt not found error
    BUG-63630	SPARK-14387. Enable Hive-1.x ORC compatibility with spark.sql.hive.convertMetastoreOrc
    BUG-58486   Use cache file created by ambari as spark.yarn.archive
    BUG-48982   Add hadoop lzo jar to the classpath
    BUG-52253   Support configuring YARN correctly for multiple Spark versions and their aux-services
    BUG-60289   Spark2 jersey and Timeline Jersey are incompatible
    BUG-59418   changes to KafkaRDD MessageAndMetadata to use named params
    BUG-61726   SparkLauncherSuite unit test failing
    BUG-63858   S3CountLines application fails in yarn-cluster mode: user should not call system.exit(0) terminate the application in spark 2
    BUG-68592   Implement `spark-llap2` package for Spark 2.1.x
    BUG-71525   Support `spark.sql.hive.llap` configuration
    BUG-60788   Spark-LLAP should support CTAS.
    SPARK-207   Remove hardcode FS scheme from Spark archive.
    BUG-77400   Fix HiveServer2 delegation token acquisition
    BUG-81926   Issue with inserting data from Spark SQL using hivecontext
    BUG-84597   Fix VersionsSuite failures

    (Backport from 2.1.2)
    SPARK-19970 Table owner should be USER instead of PRINCIPAL in kerberized clusters
    SPARK-20256 SessionState should be created more lazily
    SPARK-19372 Fix throwing a Java exception at df.fliter() due to 64KB bytecode size limit
    SPARK-20256 SessionState should be created more lazily
    SPARK-20439 Fix Catalog API listTables and getTable when failed to fetch table metadata
    SPARK-20496 Bug in KafkaWriter Looks at Unanalyzed Plans
    SPARK-20517 Fix broken history UI download link
    SPARK-20540 Fix unstable executor requests.
    SPARK-20558 clear InheritableThreadLocal variables in SparkContext when stopping it
    SPARK-20546 spark-class gets syntax error in posix mode
    SPARK-20613 Remove excess quotes in Windows executable
    SPARK-20603 Set default number of topic partitions to 1 to reduce the load
    SPARK-20616 RuleExecutor logDebug of batch results should show diff to start of batch
    SPARK-20615 SparseVector.argmax throws IndexOutOfBoundsException
    SPARK-20627 Drop the hadoop distirbution name from the Python version
    SPARK-17685 Make SortMergeJoinExec's currentVars is null when calling createJoinKey
    SPARK-20686 PropagateEmptyRelation incorrectly handles aggregate without grouping
    SPARK-20631 LogisticRegression._checkThresholdConsistency should use values not Params
    SPARK-20688 correctly check analysis for scalar sub-queries
    SPARK-20685 Fix BatchPythonEvaluation bug in case of single UDF w/ repeated arg.
    SPARK-20665 Bround" and "Round" function return NULL
    SPARK-17424 Fix unsound substitution bug in ScalaReflection.
    SPARK-20705 The sort function can not be used in the master page when you use Firefox or Google Chrome.
    SPARK-20735 Enable cross join in TPCDSQueryBenchmark
    SPARK-20769 Incorrect documentation for using Jupyter notebook
    SPARK-20796 the location of start-master.sh in spark-standalone.md is wrong
    SPARK-20798 GenerateUnsafeProjection should check if a value is null before calling the getter
    SPARK-20759 SCALA_VERSION in _config.yml should be consistent with pom.xml
    SPARK-20781 the location of Dockerfile in docker.properties.templat is wrong
    SPARK-20687 mllib.Matrices.fromBreeze may crash when converting from Breeze sparse matrix
    SPARK-20756 yarn-shuffle jar references unshaded guava
    SPARK-20763 The function of `month` and `day` return the value which is not we expected.
    SPARK-20862 Avoid passing float to ndarray.reshape in LogisticRegressionModel
    SPARK-20848 Shutdown the pool after reading parquet files
    SPARK-18406 Race between end-of-task and completion iterator read lock release
    SPARK-20848 Shutdown the pool after reading parquet files
    SPARK-20250 Improper OOM error when a task been killed while spilling data
    SPARK-20874 Add Structured Streaming Kafka Source to examples project
    SPARK-20868 UnsafeShuffleWriter should verify the position after FileChannel.transferTo
    SPARK-20843 Add a config to set driver terminate timeout
    SPARK-20393 Strengthen Spark to prevent XSS vulnerabilities
    SPARK-20275 Do not display "Completed" column for in-progress applications
    SPARK-20940 Replace IllegalAccessError with IllegalStateException
    SPARK-20922 Add whitelist of classes that can be deserialized by the launcher.
    SPARK-20922 Don't use Java 8 lambdas in older branches.
    SPARK-20974 we should run REPL tests if SQL module has code changes
    SPARK-20914 Javadoc contains code that is invalid
    SPARK-20920 ForkJoinPool pools are leaked when writing hive tables with many partitions
    SPARK-21064 Fix the default value bug in NettyBlockTransferServiceSuite
    SPARK-20211 Fix the Precision and Scale of Decimal Values when the Input is BigDecimal between -1.0 and 1.0
    SPARK-16251 Flaky test: org.apache.spark.rdd.LocalCheckpointSuite.missing checkpoint block fails with informative message
    SPARK-21072 TreeNode.mapChildren should only apply to the children node.
    SPARK-21114 Fix test failure in Spark 2.1/2.0 due to name mismatch
    SPARK-19688 Not to read `spark.yarn.credentials.file` from checkpoint.
    SPARK-21138 Cannot delete staging dir when the clusters of "spark.yarn.stagingDir" and "spark.hadoop.fs.defaultFS" are different
    SPARK-21123 Options for file stream source are in a wrong table - version to fix 2.1
    SPARK-21167 Decode the path generated by File sink to handle special characters
    SPARK-21181 Release byteBuffers to suppress netty error messages
    SPARK-20555 Fix mapping of Oracle DECIMAL types to Spark types in read path
    SPARK-21159 Don't try to connect to launcher in standalone cluster mode.
    SPARK-21203 Fix wrong results of insertion of Array of Struct
    SPARK-21176 Limit number of selector threads for admin ui proxy servlets to 8
    SPARK-21312 correct offsetInBytes in UnsafeRow.writeToStream
    SPARK-21345 SparkSessionBuilderSuite should clean up stopped sessions.
    SPARK-21083 Store zero size and row count when analyzing empty table
    SPARK-21332 Incorrect result type inferred for some decimal expressions
    SPARK-21441 Incorrect Codegen in SortMergeJoinExec results failures in some cases
    SPARK-21446 Fix setAutoCommit never executed
    SPARK-21555 RuntimeReplaceable should be compared semantically by its canonicalized child
    SPARK-21522 Fix flakiness in LauncherServerSuite.
    SPARK-12717 Adding thread-safe broadcast pickle registry
    SPARK-21330 Bad partitioning does not allow to read a JDBC table with extreme values on the partition column
    SPARK-21588 SQLContext.getConf(key, null) should return null
    SPARK-18535 Redact sensitive information
    SPARK-21306 For branch 2.1, OneVsRest should support setWeightCol

    (Backport from 2.2)
    SPARK-8617  HistoryServer: Include in-progress files during cleanup
    SPARK-20239 Improve HistoryServer's ACL mechanism
    SPARK-19995 Register tokens to current UGI to avoid re-issuing of tokens in yarn client mode
    SPARK-20345 Fix STS error handling logic on HiveSQLException
    SPARK-18629 Fix numPartition of JDBCSuite Testcase
    SPARK-4105  retry the fetch or stage if shuffle block is corrupt
    SPARK-19219 Fix Parquet log output defaults
    SPARK-18113 Use ask to replace askWithRetry in canCommit and make receiver idempotent.
    SPARK-19059 Unable to retrieve data from parquet table whose name startswith underscore
    SPARK-19218 Fix SET command to show a result correctly and in a sorted order
    SPARK-17663 SchedulableBuilder should handle invalid data access via scheduler.allocation.file
    SPARK-19263 DAGScheduler should avoid sending conflicting task set.
    SPARK-19539 Block duplicate temp table during creation
    SPARK-18986 ExternalAppendOnlyMap shouldn't fail when forced to spill before calling its iterator
    SPARK-19775 Remove an obsolete `partitionBy().insertInto()` test case
    SPARK-19631 OutputCommitCoordinator should not allow commits for already failed tasks
    SPARK-18579 Use ignoreLeadingWhiteSpace and ignoreTrailingWhiteSpace options in CSV writing
    SPARK-19868 conflict TasksetManager lead to spark stopped
    SPARK-19570 Allow to disable hive in pyspark shell
    SPARK-20405 Dataset.withNewExecutionId should be private
    SPARK-20412 Throw ParseException from visitNonOptionalPartitionSpec instead of returning null values.
    SPARK-19812 YARN shuffle service fails to relocate recovery DB acroâ€¦
    SPARK-20459 JdbcUtils throws IllegalStateException: Cause already initialized after getting SQLException
    SPARK-19104 Lambda variables in ExternalMapToCatalyst should be global
    SPARK-20566 ColumnVector should support `appendFloats` for Array
    SPARK-19846 Add a flag to disable constraint propagation
    SPARK-18971 Netty issue may cause the shuffle client hang

    (Backport from 2.3)
    SPARK-20981 Add new configuration spark.jars.repositories as equivalence of --repositories
    SPARK-21376 Fix yarn client token expire issue when cleaning the staging files in long running scenario
    SPARK-21377 Make jars specify with --jars/--packages load-able in AM's credential renwer
    SPARK-21475CORE Use NIO's Files API to replace FileInputStream/FileOutputStream in some critical paths

    (Jira in Apache Spark is IN PROGRESS)
    SPARK-15844 HistoryServer doesn't come up if spark.authenticate = true
    SPARK-21407 Support spnego for ThriftServer thrift/http auth
