Changes only in Hortonworks github and not in Apache SPARK-2.3.0 and hence not covered by CHANGES.txt.

INCOMPATIBLE CHANGES

NEW FEATURES
    SPARK-13587: Support virtualenv in pyspark

    (Support Spark Atlas Connector)
    BUG-97790  Spark Atlas Connector: support Kafka as external data source
    BUG-92048 Implement loading and visualizing Spark ML pipeline abstracts at Atlas
 
IMPROVEMENTS
    RMP-6461: Add --jarDirs and SPARK_APP_JARS to include directories in spark-submit and spark-shell
    RMP-6448: hdp.version
    RMP-6954: SparkSQL Ranger integration for fine grained access control in Spark 2.1
    BUG-70581 Add hadoop-3.0 profile
    BUG-84628 HiveServer2Credential Provider is enabled by default
    RMP-9454: SparkSQL Ranger integration for fine grained access control in Spark 2.2
    BUG-97455 Update Spark to build against Kafka 1.0
    BUG-100381 Add Hive Metastore 3.0 support
    BUG-100279 Add adl & wasb not loading

BUG FIXES
    BUG-58486   Use cache file created by ambari as spark.yarn.archive
    BUG-48982   Add hadoop lzo jar to the classpath
    BUG-52253   Support configuring YARN correctly for multiple Spark versions and their aux-services
    BUG-60289   Spark2 jersey and Timeline Jersey are incompatible
    BUG-59418   changes to KafkaRDD MessageAndMetadata to use named params
    BUG-63858   S3CountLines application fails in yarn-cluster mode: user should not call system.exit(0) terminate the application in spark 2
    BUG-68592   Implement `spark-llap2` package for Spark 2.1.x
    BUG-71525   Support `spark.sql.hive.llap` configuration
    SPARK-207   Remove hardcode FS scheme from Spark archive
    BUG-77149   Spark2 build failure in atlantic because [SPARK-17979] SPARK_YARN_USER_ENV and SPARK_JAVA_OPTS depreciated.
    BUG-79168   Spark2 compilation failure because (1)LLAP related patches are missing (2) conflict between hdp-master and Apache/master in the Client.scala
    BUG-77776   Fix STS error handling logic on HiveSQLException
    BUG-81926   Issue with inserting data from Spark SQL using hivecontext
    BUG-77400   Fix HiveServer2 delegation token acquisition
    BUG-84597   Fix VersionsSuite failures
    BUG-86685   Fix SparkLauncherSuite.testChildProcLauncher
    BUG-86834   Add missing import package name in HiveServer2CredentialProvider
    BUG-90803   Added hadoop-azure-datalake and azure-data-lake-store-sdk to all the wasb locations
    BUG-95434   Fix connection string to use `isRunningInYarnContainer`
    BUG-99560   Enable `kafka-0-8` build in atlantic by using Kafka `0.10.1.2.6.4.0-91`

    (Backport from 2.3.1)
    SPARK-23475 Show also skipped stages
    SPARK-23438 Fix DStreams data loss with WAL when driver crashes
    SPARK-23449 Preserve extraJavaOptions ordering
    SPARK-23365 Do not adjust num executors when killing idle executors.
    SPARK-23448 Clarify JSON and CSV parser behavior in document
    SPARK-23508 Fix BlockmanagerId in case blockManagerIdCache cause oom
    SPARK-23517 Make `pyspark.util._exception_message` produce the trace from Java side by Py4JJavaError
    SPARK-23551 Exclude `hadoop-mapreduce-client-core` dependency from `orc-mapreduce`
    SPARK-23570 Add Spark 2.3.0 in HiveExternalCatalogVersionsSuite
    SPARK-22883 Streaming tests for spark.ml.feature, from A to H
    SPARK-23569 Allow pandas_udf to work with python3 style type-annotated functions
    SPARK-23329 Fix documentation of trigonometric functions
    SPARK-22882 ML test for structured streaming: ml.classification
    SPARK-23457 Register task completion listeners first in ParquetFileFormat
    SPARK-23434 Spark should not warn `metadata directory` for a HDFS file path
    SPARK-23601 Remove .md5 files from release
    SPARK-23525 Support ALTER TABLE CHANGE COLUMN COMMENT for external hive table
    SPARK-23020 Fix another race in the in-process launcher test.
    SPARK-23524 Big local shuffle blocks should not be checked for corruption.
    SPARK-23490 Check storage.locationUri with existing table in CreateTable
    SPARK-23406 Enable stream-stream self-joins for branch-2.3
    SPARK-23436 Infer partition as Date only if it can be casted to Date
    SPARK-23630 Allow user's hadoop conf customizations to take effect.
    SPARK-23628 calculateParamLength should not return 1 + num of expressions
    SPARK-23173 Avoid creating corrupt parquet files when loading data from JSON
    SPARK-23624 Revise doc of method pushFilters in Datasource V2
    SPARK-23462 improve missing field error message in `StructType`
    SPARK-23598 Make methods in BufferedRowIterator public to avoid runtime error for a large query
    SPARK-22915 Streaming tests for spark.ml.feature, from N to Z
    SPARK-23642 AccumulatorV2 subclass isZero scaladoc fix
    SPARK-23695 Fix the error message for Kinesis streaming tests
    SPARK-23658 InProcessAppHandle uses the wrong class in getLogger
    SPARK-23671 Fix condition to enable the SHS thread pool.
    SPARK-23608 Add synchronization in SHS between attachSparkUI and detachSparkUI functions to avoid concurrent modification issue to Jetty Handlers
    SPARK-23670 Fix memory leak on SparkPlanGraphWrapper
    SPARK-23553 Tests should not assume the default value of `spark.sql.sources.default`
    SPARK-23706 spark.conf.get(value, default=None) should produce None in PySpark
    SPARK-23728 Fix ML tests with expected exceptions running streaming tests
    SPARK-23660 Fix exception in yarn cluster mode when application ended fast
    SPARK-23644 Use absolute path for REST call in SHS
    SPARK-23691 Use sql_conf util in PySpark tests where possible
    SPARK-23649 Skipping chars disallowed in UTF-8
    SPARK-23264 Fix scala.MatchError in literals.sql.out
    SPARK-23288 Fix output metrics with parquet sink
    SPARK-23729 Respect URI fragment when resolving globs
    SPARK-23760 CodegenContext.withSubExprEliminationExprs should save/restore CSE state correctly
    SPARK-23614 Fix incorrect reuse exchange when caching is used
    SPARK-23769 Remove comments that unnecessarily disable Scalastyle check
    SPARK-23759 Unable to bind Spark UI to specific host name / IP
    SPARK-23623 Avoid concurrent use of cached consumers in CachedKafkaConsumer (branch-2.3)
    SPARK-23788 Fix race in StreamingQuerySuite
    SPARK-23599 Add a UUID generator from Pseudo-Random Numbers
    SPARK-23645 Add docs RE `pandas_udf` with keyword args
    SPARK-23599 Use RandomUUIDGenerator in Uuid expression
    SPARK-23806 Broadcast.unpersist can cause fatal exception when used with dynamic allocation
    SPARK-23808 Set default Spark session in test-only spark sessions.
    SPARK-23639 Obtain token before init metastore client in SparkSQL CLI
    SPARK-23827 StreamingJoinExec should ensure that input data is partitioned into specific number of partitions
    SPARK-23040 Returns interruptible iterator for shuffle reader
    SPARK-19964 Avoid reading from remote repos in SparkSubmitSuite.
    SPARK-23802 PropagateEmptyRelation can leave query plan in unresolved state
    SPARK-23838 Running SQL query is displayed as "completed" in SQL tab
    SPARK-23637 Yarn might allocate more resource if a same executor is killed multiple times
    SPARK-23823 Keep origin in transformExpression
    SPARK-23822 Improve error message for Parquet schema mismatches
    SPARK-23809 Active SparkSession should be set by getOrCreate
    SPARK-23881 Fix flaky test JobCancellationSuite."interruptible iterator of shuffle reader"
    SPARK-23816 Killed tasks should ignore FetchFailures.
    SPARK-23942 PySpark's collect doesn't trigger QueryExecutionListener
    SPARK-23004 Ensure StateStore.commit is called only once in a streaming aggregation task
    SPARK-24033 Fix Mismatched of Window Frame specifiedwindowframe(RowFrame, -1, -1)
    SPARK-24022 Make SparkContextSuite not flaky
    SPARK-23989 exchange should copy data before non-serialized shuffle
    SPARK-24021 fix bug in BlacklistTracker's updateBlacklistForFetchFailure
    SPARK-24014 Add onStreamingStarted method to StreamingListener
    SPARK-23963 Properly handle large number of columns in query on text-based Hive table
    SPARK-24007 EqualNullSafe for FloatType and DoubleType might generate a wrong result by codegen.
    SPARK-23948 Trigger mapstage's job listener in submitMissingTasks
    SPARK-23986 freshName can generate non-unique names
    SPARK-23835 Add not-null check to Tuples' arguments deserialization
    SPARK-23815 Spark writer dynamic partition overwrite mode may fail to write output on multi level partition
    SPARK-23748 Fix SS continuous process doesn't support SubqueryAlias issue
    SPARK-23867 use droppedCount in logWarning
    SPARK-23962 Fix race in currentExecutionIds().
    SPARK-22883 ML test for StructuredStreaming: spark.ml.feature, I-M
    SPARK-24062 Fix SASL encryption cannot enabled issue in thrift server
    SPARK-24085 Query returns UnsupportedOperationException when scalar subquery is present in partitioning expression
    SPARK-24104 SQLAppStatusListener overwrites metrics onDriverAccumUpdates instead of updating them
    SPARK-23853 Run Hive-related PySpark tests only for `-Phive`
    SPARK-23941 Mesos task failed on specific spark app name
    SPARK-24107 ChunkedByteBuffer.writeFully method has not reset the limit value
    SPARK-23971 Should not leak Spark sessions across test suites
    SPARK-23489 HiveExternalCatalogVersionsSuite should verify the downloaded file
    SPARK-24166 InMemoryTableScanExec should not access SQLConf at executor side
    SPARK-24133 Check for integer overflows when resizing WritableColumnVectors
    SPARK-24169 JsonToStructs should not access SQLConf at executor side
    SPARK-23433 Late zombie task completions update all tasksets
    SPARK-24168 WindowExec should not access SQLConf at executor side
    SPARK-23697 LegacyAccumulatorWrapper should define isZero correctly

    (Backport from 2.4)
    SPARK-23228 Add Python Created jsparkSession to JVM's defaultSession
    SPARK-23340 Upgrade Apache ORC to 1.4.3
    SPARK-23456 Turn on `native` ORC impl and PPD by default
    SPARK-21783 Turn on `native` ORC impl and PPD by default
    SPARK-23523 Fix the incorrect result caused by the rule OptimizeMetadataOnlyQuery
    SPARK-23523 Minor refactor of OptimizeMetadataOnlyQuery
    SPARK-23510 Support Hive 2.2 and Hive 2.3 metastore
    SPARK-23518 Avoid metastore access when the users only want to read and write data frames
    SPARK-23635 Spark executor env variable is overwritten by same name AM env variable
    SPARK-23787 Fix file download test in SparkSubmitSuite for Hadoop 2.9.
    SPARK-23355 convertMetastore should not ignore table properties
    SPARK-24110 Avoid UGI.loginUserFromKeytab in STS
